# 목표

- 자가적응형(Closed-loop) AI가 “판단에 필요한 정보”를 정확하게 가져올 수 있도록, 데이터 형식을 규정하고 단일 저장소에 집약한다.
- 건강기능식품(영양제) 관련 데이터를 “도메인 특화” 형태로 통합 관리하여, (1) 유료/전문 의약학 DB 및 문헌 근거를 포함한 조회·참조, (2) 사용자·서비스 내부 데이터(행동/상호작용/연산결과 등)의 축적·재사용이 가능하도록 한다.

# 입력/출력(계약)

## 입력(수집/적재 대상)

아래 입력은 “단일 저장소 집약”의 대상이며, 데이터 형식은 규정되어야 한다.

1. 개인 특성 파라미터

- 예: 성별, 연령, 키, 체중, 병력, 증상, 복용 약물, 생활 습관 등
- 출처 예: UI 입력, 마이데이터 간편 연동(신체·병력·복용 약물 등)

2. 도메인 전문 근거 데이터(의·약학 전문 문헌/DB)

- 예: 의·약학 DB(Micromedex, USP, Natural Medicines Database 등), 의·약학 학술지/문헌(PubMed, JAMA, Cochrane Library 등)
- 예: 규제/공공 안전성 데이터(식품의약품안전처 건강기능식품·의약품 안전성 데이터 등)
- 예: 의약품 상세 정보 데이터베이스(약학정보원 등)

3. 유저 행동 패턴 데이터

- 예: 상품 노출 횟수/시간, 구매 내역, 재구매율, 세션/디바이스별 체류 시간 및 이탈률, 공유/푸시 알림 수신·열람 통계 등

4. 유저 상호작용 로그 데이터

- 예: 유저–LLM(상담) 대화 로그의 키워드 수집·분석 등, 서비스 내 상호작용 로그

5. 엔진·모델 연산 결과 데이터

- 예: 추천/최적화/추론 결과, 의사결정(조합/선택) 결과, 결과 로그(추론 근거 연결 포함)

## 출력(조회/제공 대상)

- Closed-loop AI가 “근거 데이터” 및 “개인/행동/로그/연산결과”를 조회하여, 이후 모듈(안전 검증, 효과 정량화, 최적화, 상담, 지속케어 등)에서 활용할 수 있어야 한다.
- 외부 요청 데이터 탐색·호출 결과 및 내부 결과 로그가 저장·재사용 가능해야 한다.

# 기능 요구사항

## 1) 데이터 형식 규정 및 통합 저장

- 건강기능식품 관련 데이터 및 연동 데이터의 형식을 통일하고, 단일 저장소로 집약해야 한다.
- “자가적응형 AI가 판단을 위해 필요한 정보를 조회”할 수 있도록, 데이터 단위/구조가 정의되어야 한다.

## 2) 전문 근거 데이터의 가공 가능성

- 전문 문헌/DB 데이터는 “분할(문단/표 단위 등) → 태깅(주제, 질환, 성분, 상호작용 등) → 인덱싱(검색/벡터 등)”이 가능한 형태로 정리될 수 있어야 한다.
- 위 과정의 세부 구현 방식은 강제하지 않으며, 결과적으로 AI가 정확히 참조 가능한 형태(근거 단위 식별 가능)여야 한다.

## 3) 도메인 특화 데이터 레이크(Domain-specific Data Lake)

- 서비스 내부 데이터(개인 특성/행동/상호작용/연산결과)와 외부 근거 데이터(전문 DB/문헌/안전성 데이터)를 동일한 체계로 통합 관리할 수 있어야 한다.
- 외부 요청 데이터의 탐색/호출 결과를 저장하고, 후속 모듈이 재사용할 수 있어야 한다.

## 4) 운영 중 축적 및 갱신

- 사용자가 늘어날수록(상태·행동·피드백 축적) 데이터가 누적되어 Closed-loop AI가 지속적으로 활용할 수 있어야 한다.
- 데이터 갱신(추가/수정/정정)의 흔적을 남길 수 있어야 한다(평가 재현을 위함).

# 비기능 요구사항

## 1) 정확성/추적 가능성(근거 연결)

- AI가 답변/판단에 사용한 근거가 “어떤 데이터(문헌/DB/안전성 자료/내부 로그)”에서 왔는지 추적 가능해야 한다.

## 2) 개인정보/민감정보 처리

- 개인 특성 파라미터 및 건강 관련 데이터는 민감정보가 될 수 있으므로, 접근 통제/기록/보관 기준을 명시하고 준수해야 한다.
- (구현 방식은 강제하지 않되) 권한 없는 접근이 불가능하도록 설계되어야 한다.

## 3) 확장성

- 신규 데이터 소스(예: 추가 논문 DB, 신규 공공데이터, 신규 센서 데이터)가 추가되더라도, “형식 규정 + 단일 저장소 집약” 원칙을 유지할 수 있어야 한다.

# 성능지표(KPI)

- Data Lake에 저장된 근거/레퍼런스를 기반으로 산출되는 “레퍼런스 정확도”는 전체 평가 KPI의 일부로 측정된다.
- 본 모듈은 최소한 다음이 가능하도록 데이터/로그/근거 단위를 제공해야 한다:
  - (1) 근거(문헌/DB/공공 안전성 등) 참조 정확도 산정
  - (2) 데이터/근거 추적(어떤 근거를 썼는지) 및 재현 가능한 결과 저장

# 평가방법(이 모듈 관점)

- 평가의 최종 판정은 `docs/rnd/01_kpi_and_evaluation.md`의 “안전/근거: Data Lake 레퍼런스 정확도(%)” 정의를 따른다.
- 본 모듈은 위 평가가 가능하도록 다음을 제공해야 한다:
  - 평가 표본(규칙/질의/시나리오)별로, (a) 시스템이 참조한 근거 ID/원문 단위(분할 단위), (b) 근거 출처 종류(문헌/DB/공공/내부), (c) 근거 연결 경로를 기록
  - 평가 데이터셋(또는 생성 규칙)과 동일 절차로 반복 평가 가능한 실행 조건

# 평가환경(이 모듈 관점)

- “외부 공신력 환경”에서의 평가를 전제로 하며, 시험기관 수준의 환경에서 재현 가능하도록 데이터/절차/결과를 보관해야 한다.
- 데이터 소스는 최소한 “문헌/DB/공공 안전성 데이터 + 서비스 내부 데이터(개인/행동/로그/연산결과)”가 포함된 형태여야 하며, 평가 시 동일 조건으로 재현 가능해야 한다.

# 재현 가능한 산출물

- 데이터 형식 정의(버전 포함)
- 데이터 소스 목록(종류/범위/갱신 기준)
- 근거 분할/태깅/인덱싱 결과를 식별할 수 있는 단위 ID 체계(구현 방식은 무관)
- 평가 표본별 근거 연결 로그(재현 가능 형태)
