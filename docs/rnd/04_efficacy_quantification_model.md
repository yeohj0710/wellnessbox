# 목표

- 엔진이 추천한 건강기능식품(영양제) 복용을 통해 사용자의 건강 상태가 실제로 개선되었는지를 “수치(정량 지표)”로 산출한다.
- 사용자별 복용 전/후 변화를 표준화된 방식으로 계산하여, 기술개발 성능지표(KPI)인 “실제 효과 측정치 개선도(pp)” 평가가 가능하도록 한다.
- 산출된 정량 결과는 Closed-loop AI의 후속 행동 판단(유지/변경/중단/추가상담 등) 및 추천/최적화 단계의 피드백 신호로 활용될 수 있어야 한다.

# 입력/출력(계약)

## 입력

1. 개인 특성 파라미터(사용자 상태)

- 예: 성별/연령 등 신체 특성, 병력/증상, 생활습관, 건강 목표 등

2. 복용 이력/계획(개입 정보)

- 예: 추천 조합(제품/성분), 용량, 주기, 기간, 순응도(복용 여부/중단 여부) 등

3. 효과 측정 데이터(전/후 비교 가능한 관측치)

- 예: 설문/자가보고(PRO) 기반 지표
- 예: 건강 관련 수치(검사/바이오마커 등) 또는 기기 기반 측정치(가능한 범위 내)
- 예: (가능 시) 바이오센서 기반 측정치(웨어러블/연속혈당 등)

## 출력

1. 사용자별 효과 정량화 결과

- 복용 전/후 비교를 위한 표준화된 점수(또는 동등한 정량 지표)
- 전/후 변화량 및 개선도(pp) 산출에 필요한 값(평가 재현 가능 형태)

2. 평가/재현을 위한 메타 정보

- 사용된 입력 데이터 범위(측정 기간, 지표 종류, 결측/제외 기준 등)
- 동일 조건 재평가를 위한 식별 정보(데이터 버전/기간/대상)

# 핵심 기능 요구사항

## 1) 전/후 비교를 위한 측정 설계

- 복용 전(pre)과 복용 후(post)를 정의할 수 있어야 하며, 동일 사용자 기준으로 비교 가능해야 한다.
- 전/후 측정은 “동일 지표” 또는 “상호 비교 가능한 지표 집합”으로 구성되어야 한다.
- 측정 기간(윈도우) 및 포함 기준(최소 측정 횟수 등)을 정의하고 적용할 수 있어야 한다.

## 2) 효과 측정치의 표준화(정규화)

- 서로 다른 단위/스케일(설문 점수, 수치형 바이오마커 등)을 비교 가능하도록 표준화된 점수 또는 동등한 방식의 정규화를 수행할 수 있어야 한다.
- 표준화 규칙은 평가 시 재현 가능해야 한다(동일 입력이면 동일 출력).

## 3) 개선도(pp) 산출을 위한 결과 생성

- `docs/rnd/01_kpi_and_evaluation.md`에 정의된 “실제 효과 측정치 개선도(pp)” 산출이 가능하도록,
  - 사용자별 전/후 표준화 점수(또는 평가식에 필요한 값)
  - 집계 가능한 형태의 결과(사용자 단위 결과 리스트)
    를 제공할 수 있어야 한다.

## 4) 데이터 결측/이상치 처리(평가 가능성 관점)

- 전/후 측정치 결측, 순응도 부족(복용 미이행), 이상치 등으로 인해 비교가 불가능한 경우를 식별할 수 있어야 한다.
- 제외/보정 규칙(가능하면 단순·명시적 규칙)을 기록하여 평가 재현이 가능해야 한다.

# 비기능 요구사항

## 1) 재현성

- 동일한 입력 데이터(전/후 측정치, 기간, 표준화 규칙)로 실행하면 동일한 결과가 산출되어야 한다.

## 2) 추적 가능성

- 산출된 개선도(pp)가 어떤 측정치(지표 종류/기간/전처리 규칙)에 의해 도출되었는지 추적 가능해야 한다.

## 3) 개인정보/민감정보 보호

- 건강 관련 측정치 및 개인 특성 파라미터는 민감정보가 될 수 있으므로, 접근 통제/기록/보관 기준을 준수할 수 있어야 한다.

# 성능지표(KPI)

- 본 모듈은 `docs/rnd/01_kpi_and_evaluation.md`의 다음 항목 평가를 지원해야 한다.
  - 효과: “엔진 추천 복용을 통한 실제 효과 측정치 개선도(pp)”
- 최종 목표치는 “0pp 초과(유의한 개선)”으로 정의되며, 구체 계산식/판정 기준은 01 문서를 따른다.

# 평가방법(이 모듈 관점)

- 최종 KPI 계산식/판정 기준은 `docs/rnd/01_kpi_and_evaluation.md`를 따른다.
- 본 모듈은 평가 수행을 위해 최소한 아래를 제공해야 한다.
  - 사용자별 전(pre)/후(post) 측정치(또는 표준화 점수) 산출 결과
  - 전/후 기간 정의 및 데이터 포함/제외 규칙(결측, 순응도 등)
  - 반복 실행 가능한 평가 입력/출력 포맷(재현 가능 형태)

# 평가환경(이 모듈 관점)

- “외부 공신력 환경”에서 평가가 가능하도록, 평가 데이터셋(또는 생성 규칙), 평가 절차, 결과 리포트가 동일 조건에서 재현 가능하게 보관되어야 한다.
- 전/후 비교 평가를 위해, 최소한 “개입(복용 추천/실제 복용)”과 “측정(전/후)”이 연결된 데이터가 확보되어야 한다.

# 재현 가능한 산출물

- 전/후 비교 설계(기간/측정 지표 정의)
- 표준화(정규화) 규칙 정의 및 버전
- 사용자별 결과 산출 포맷(전/후 값, 변화량, 집계용 값)
- 평가 실행 절차(스크립트/쿼리/설정 또는 동등한 재현 가능 수단)
