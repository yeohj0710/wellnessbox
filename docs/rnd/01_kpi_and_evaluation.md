# 문서 목적

본 문서는 TIPS 연구개발계획서의 “기술개발(II-2. 기술개발 내용 및 목표)” 수행 결과를 판정하기 위한 **성능지표(KPI)**, **평가방법**, **평가환경**을 정리한다. 본 문서의 지표/평가 정의는 구현 방식(아키텍처/모델/데이터 구조)에 우선하며, 기술개발 완료 여부는 본 문서 기준 충족으로 판단한다.

# 적용 범위

- 본 문서는 `docs/rnd/02~07_*.md` 전체 모듈에 공통으로 적용되는 “합격 기준”이다.
- 각 모듈은 본 문서의 KPI 정의에 맞춰 필요한 입력/출력/로그/데이터를 생성할 수 있어야 한다.

# 결과물 성능지표(KPI)

아래 KPI는 기술개발 결과물 평가의 주요 지표이며, 최종 목표치와 가중치는 연구개발계획서에 기재된 기준을 따른다.

| 분류        | 평가 항목(주요 성능)                                    |    단위 |           최종 목표치 | 가중치(%) |
| ----------- | ------------------------------------------------------- | ------: | --------------------: | --------: |
| 추천/최적화 | 건강기능식품 추천 정확도                                |       % |                   80% |        20 |
| 효과        | 엔진 추천 복용을 통한 실제 효과 측정치 개선도           |      pp | 0pp 초과(유의한 개선) |        20 |
| Closed-loop | 다음 수행 작업 판단 및 수행 정확도                      |       % |                   80% |        20 |
| Closed-loop | 상담 모듈(대화형 LLM) 답변 정확도                       |       % |                   91% |        20 |
| 안전/근거   | 안전 검증 엔진 제공 데이터 및 Data Lake 레퍼런스 정확도 |       % |                   95% |        10 |
| 안전        | 약물이상반응 집계 보고 건수                             | 건/year |         5건/year 이하 |         5 |
| 연동        | 바이오센서·유전자 데이터 연동율                         |       % |                   90% |         5 |

# 평가방법(측정 정의) 및 판정 기준

본 절은 KPI 계산식/절차/판정 기준을 정의한다.

## 1) 건강기능식품 추천 정확도(%)

- 약사 그룹이 도출한 성분 집합을 \(R_i\), 엔진이 산출한 복용 조합의 성분 합집합을 \(\Gamma_i\) 라고 할 때, 각 케이스 점수:
  - \( s_i = 100 \times \frac{|R_i \cap \Gamma_i|}{|R_i|} \)
- 전체 점수:
  - \( Score = \frac{1}{N}\sum\_{i=1}^{N}s_i \)
- 데이터 조건:
  - 테스트 케이스 최소 100 case 이상
- 판정 기준:
  - 평균 점수(성분 조합 일치율) 80% 이상

## 2) 실제 효과 측정치 개선도(pp)

- 개인 \(i\)의 복용 전/후 표준화 점수 \(\hat{z}_{pre,i}\), \(\hat{z}_{post,i}\)에 대해:
  - \( p*i = 100 \times [\Phi(\hat{z}*{post,i}) - \Phi(\hat{z}\_{pre,i})] \)  
    ( \(\Phi\): 표준정규분포 CDF )
- 전체 개선도:
  - \( SCGI = \frac{1}{N}\sum\_{i=1}^{N} p_i \)
- 판정 기준:
  - 평균 \(\Delta z\)가 0pp 초과(유의한 개선)

## 3) Closed-loop 다음 수행 작업 판단 및 수행 정확도(%)

- 전체 테스트 작업 집합 \(S\)에 대해 정답 작업 \(a_s^\*\), 시스템 수행 작업 \(a_s\), 성공 플래그 \(e_s \in \{0,1\}\)일 때:
  - \( Accuracy = 100 \times \frac{\sum\_{s\in S} \mathbb{1}(a_s=a_s^\* \land e_s=1)}{|S|} \)
- 데이터 조건:
  - 테스트 케이스 최소 100 case 이상
- 판정 기준:
  - 정확도 80% 이상

## 4) 상담 모듈(대화형 LLM) 답변 정확도(%)

- 전체 테스트 문항 집합 \(Q\)에 대해 적절성 판정 함수 \(g(answer_q)\in\{0,1\}\)를 정의할 때:
  - \( Accuracy = 100 \times \frac{\sum\_{q\in Q} g(answer_q)}{|Q|} \)
- 데이터 조건:
  - 테스트 문항 최소 100문항 이상
- 판정 기준:
  - 정답(적절) 일치율 91% 이상

## 5) 안전 검증 엔진 제공 데이터 및 Data Lake 레퍼런스 정확도(%)

- 표본 규칙 \(r=1..R\)에 대해, 엔진이 산출한 논리 \(l*r\) 및 레퍼런스 \(f_r\)가 정답 \((l*{ref}, f\_{ref})\)와 일치하면 성공으로 가정:
  - \( Accuracy = 100 \times \frac{1}{R}\sum*{r=1}^{R} \mathbb{1}(l_r=l*{ref} \land f*r=f*{ref}) \)
- 데이터 조건:
  - 표본 규칙 최소 100개 이상
- 판정 기준:
  - 정확도 95% 이상

## 6) 약물이상반응(Adverse Event) 집계 보고 건수(건/year)

- 정의:
  - 엔진 추천 건강기능식품 복용으로 인한 약물이상반응을 집계 보고한 건수
- 판정 기준:
  - 측정 시점 기준 직전 12개월 누적 5건/year 이하

## 7) 바이오센서·유전자 데이터 연동율(%)

- 데이터 집합 \(s \in \{W, C, G\}\) (W: 웨어러블, C: 연속혈당, G: 유전자검사)에 대해 성공 세션 수 \(r_s\), 전체 세션 수 \(s\)일 때:
  - \( r_s = 100 \times \frac{\text{성공 세션 수}}{\text{전체 세션 수}} \)
- Data Lake 반영 비율:
  - \( R = \frac{1}{3}(r_W + r_C + r_G) \)
- 데이터 조건:
  - 데이터 집합 샘플 최소 100개 이상(W/C/G 각 10세트 이상 포함)
- 판정 기준:
  - 연동 반영율 90% 이상

# 평가환경

- KPI 평가는 “외부 공신력 환경”을 전제로 하며, TTA, 와이즈스톤 등 KOLAS 인정 시험기관 수준의 평가환경에서 수행하는 것을 기본 원칙으로 한다.

# 재현 가능성(평가 산출물)

각 KPI는 동일 조건에서 반복 산출 가능해야 한다. 따라서 평가 수행 시 아래를 함께 보관한다.

- 평가 데이터셋(또는 데이터 생성 규칙)
- KPI 산출 절차(스크립트/쿼리/설정)
- 평가 실행 환경(버전/의존성/실행 커맨드)
- 결과 리포트(산출값 및 판정 근거)
